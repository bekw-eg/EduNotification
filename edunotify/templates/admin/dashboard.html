{% extends 'base.html' %}

{% block content %}
<h1 class="card-title">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—ñ</h1>

<div class="row" style="margin-bottom: 30px;">
    <div class="col-3">
        <div class="card" style="text-align: center;">
            <h3>–•–∞–±–∞—Ä–ª–∞–Ω–¥—ã—Ä—É–ª–∞—Ä</h3>
            <p style="font-size: 28px; font-weight: bold; margin: 10px 0;">{{ total_notifications }}</p>
            <small>–ë“Ø–≥—ñ–Ω: {{ today_notifications }}</small>
        </div>
    </div>
    
    <div class="col-3">
        <div class="card" style="text-align: center;">
            <h3>–ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–ª–∞—Ä</h3>
            <p style="font-size: 28px; font-weight: bold; margin: 10px 0;">{{ total_users }}</p>
            <small>–ê–¥–º–∏–Ω–¥–µ—Ä: {{ admin_count }}</small>
        </div>
    </div>
    
    <div class="col-3">
        <div class="card" style="text-align: center;">
            <h3>–ì—Ä—É–ø–ø–∞–ª–∞—Ä</h3>
            <p style="font-size: 28px; font-weight: bold; margin: 10px 0;">{{ total_groups }}</p>
        </div>
    </div>
    
    <div class="col-3">
        <div class="card" style="text-align: center;">
            <h3>–ë–µ–ª—Å–µ–Ω–¥—ñ–ª—ñ–∫</h3>
            <p style="font-size: 28px; font-weight: bold; margin: 10px 0;">{{ recent_activity }}</p>
            <small>–°–æ“£“ì—ã 7 –∫“Ø–Ω</small>
        </div>
    </div>
</div>

<div class="row" style="margin-bottom: 30px;">
    <div class="col-6">
        <div class="card">
            <h3 class="card-title">–ñ—ã–ª–¥–∞–º ”ô—Ä–µ–∫–µ—Ç—Ç–µ—Ä</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <a href="{% url 'create_notification' %}" class="btn btn-primary" style="text-align: center;">
                    üì¢ –ñ–∞“£–∞ —Ö–∞–±–∞—Ä–ª–∞–Ω–¥—ã—Ä—É
                </a>
                <a href="{% url 'manage_groups' %}" class="btn btn-success" style="text-align: center;">
                    üë• –ì—Ä—É–ø–ø–∞ “õ–æ—Å—É
                </a>
                <a href="{% url 'user_management' %}" class="btn btn-warning" style="text-align: center;">
                    üë§ –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã–ª–∞—Ä
                </a>
                <a href="/admin/" class="btn btn-secondary" style="text-align: center;">
                    ‚öôÔ∏è Django Admin
                </a>
            </div>
        </div>
    </div>
    
    <div class="col-6">
        <div class="card">
            <h3 class="card-title">–°–æ“£“ì—ã —Ö–∞–±–∞—Ä–ª–∞–Ω–¥—ã—Ä—É–ª–∞—Ä</h3>
            
            {% if recent_notifications %}
                {% for notification in recent_notifications %}
                    <div style="padding: 10px; border-bottom: 1px solid #eee; margin-bottom: 8px;">
                        <div style="font-weight: bold; font-size: 14px;">
                            <a href="{% url 'notification_detail' notification.id %}" style="color: #0066cc; text-decoration: none;">
                                {{ notification.title }}
                            </a>
                        </div>
                        <div style="font-size: 12px; color: #666;">
                            {{ notification.created_at|date:"d.m.Y H:i" }} | 
                            <span class="{% if notification.notification_type == 'general' %}badge-general{% else %}badge-group{% endif %}" 
                                  style="padding: 1px 6px; border-radius: 10px; font-size: 10px;">
                                {{ notification.get_notification_type_display }}
                            </span>
                            {% if notification.group %}
                                | {{ notification.group.name }}
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
                <div style="text-align: center; margin-top: 10px;">
                    <a href="{% url 'notifications' %}" class="btn btn-sm btn-secondary">–ë–∞—Ä–ª—ã“ì—ã–Ω –∫”©—Ä—É</a>
                </div>
            {% else %}
                <p style="text-align: center; color: #666; padding: 20px 0;">”ò–ª—ñ —Ö–∞–±–∞—Ä–ª–∞–Ω–¥—ã—Ä—É –∂–æ“õ</p>
            {% endif %}
        </div>
    </div>
</div>

<div class="row">
    <div class="col-6">
        <div class="card">
            <h3 class="card-title">–°–æ“£“ì—ã —Ç—ñ—Ä–∫–µ–ª–≥–µ–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã–ª–∞—Ä</h3>
            
            {% if recent_users %}
                <table class="table">
                    <thead>
                        <tr>
                            <th>–ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã</th>
                            <th>–†–æ–ª—å</th>
                            <th>–ì—Ä—É–ø–ø–∞</th>
                            <th>–ö“Ø–Ω—ñ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in recent_users %}
                            <tr>
                                <td>
                                    <a href="#" style="color: #0066cc; text-decoration: none;">
                                        {{ user.username }}
                                    </a>
                                </td>
                                <td>
                                    <span class="{% if user.role == 'admin' %}user-role admin{% else %}user-role user{% endif %}" 
                                          style="font-size: 11px; padding: 2px 8px;">
                                        {{ user.get_role_display }}
                                    </span>
                                </td>
                                <td>{% if user.group %}{{ user.group.name }}{% else %}-{% endif %}</td>
                                <td>{{ user.date_joined|date:"d.m.Y" }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div style="text-align: center;">
                    <a href="{% url 'user_management' %}" class="btn btn-sm btn-secondary">–ë–∞—Ä–ª—ã“õ –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã–ª–∞—Ä</a>
                </div>
            {% else %}
                <p style="text-align: center; color: #666;">”ò–ª—ñ –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã–ª–∞—Ä –∂–æ“õ</p>
            {% endif %}
        </div>
    </div>
    
    <div class="col-6">
        <div class="card">
            <h3 class="card-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–ª—ã“õ –∞“õ–ø–∞—Ä–∞—Ç</h3>
            <div style="padding: 15px;">
                <div style="margin-bottom: 15px;">
                    <h4>–•–∞–±–∞—Ä–ª–∞–Ω–¥—ã—Ä—É–ª–∞—Ä–¥—ã“£ —Ç–∞—Ä–∞–ª—É—ã</h4>
                    <div style="background-color: #f8f9fa; padding: 10px; border-radius: 5px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>–ñ–∞–ª–ø—ã —Ö–∞–±–∞—Ä–ª–∞–Ω–¥—ã—Ä—É–ª–∞—Ä:</span>
                            <strong>{{ general_count|default:"0" }}</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>–ì—Ä—É–ø–ø–∞–ª—ã“õ —Ö–∞–±–∞—Ä–ª–∞–Ω–¥—ã—Ä—É–ª–∞—Ä:</span>
                            <strong>{{ group_count|default:"0" }}</strong>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4>–ñ“Ø–π–µ –∫“Ø–π—ñ</h4>
                    <div style="background-color: #f8f9fa; padding: 10px; border-radius: 5px;">
                        <div style="display: flex; align-items: center; margin-bottom: 5px;">
                            <div style="width: 10px; height: 10px; background-color: #28a745; border-radius: 50%; margin-right: 10px;"></div>
                            <span>–ñ“Ø–π–µ “õ–∞–ª—ã–ø—Ç—ã –∂“±–º—ã—Å —ñ—Å—Ç–µ—É–¥–µ</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <div style="width: 10px; height: 10px; background-color: #28a745; border-radius: 50%; margin-right: 10px;"></div>
                            <span>–ë–∞–∑–∞ “õ–æ—Å—ã–ª—ã–º –±–µ–ª—Å–µ–Ω–¥—ñ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}